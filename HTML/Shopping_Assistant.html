<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon Footprint Calculator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome CDN for your header icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" xintegrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Your existing header CSS starts here */
        * {
            margin : 0;
            padding: 0;
            box-sizing: border-box;
        }

        .navbar {
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            padding: 20px 20px;
            background: #2A7B9B;
            background: linear-gradient(90deg, rgba(42, 123, 155, 1) 0%, rgba(62, 157, 145, 1) 22%, rgba(72, 173, 140, 1) 33%, rgba(87, 199, 133, 1) 50%, rgba(237, 221, 83, 1) 100%); /* Green background */
            color: white; /* White text */
            height: 80px;
            position: fixed; /* Keep it fixed */
            width: 100%;
            top: 0; /* Ensure it's at the very top */
            z-index: 1000; /* Ensure navbar stays on top of other content */
        }

        .first-box {
            display: flex;
            justify-content: space-evenly;
            align-items: center;
        }

        .nav-links {
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            font-size: 1.2rem; /* Adjusted for better fit with text */
            padding: 10px; /* Added padding to make links clickable */
            border-radius: 5px; /* Rounded corners */
            transition: background-color 0.3s ease; /* Smooth hover */
        }

        .border {
            border: 1px solid transparent; /* Changed to transparent, as your hover adds background color */
        }

        .border:hover {
            background-color: rgba(255, 255, 255, 0.1); /* Light hover effect */
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 2.0rem; /* Adjusted for better fit */
            font-weight: bold; /* Added bold for prominence */
        }

        .logo span {
            margin-left: 10px; /* Space between icon and text */
        }

        .profile {
            font-size : 1.2rem; /* Adjusted for consistency */
        }

        .nav-links a{
            text-decoration: none; /* Remove underline from links */
            color: white; /* White text for links */
            display: flex; /* Allow icon and text to align */
            align-items: center;
        }

        .nav-links a i {
            margin-right: 8px; /* Space between icon and text */
        }

        /* Carbon Footprint Calculator custom styles start here */
        body {
            /* Applied the gradient background to the body */
            background: linear-gradient(90deg, rgba(42, 123, 155, 1) 0%, rgba(62, 157, 145, 1) 22%, rgba(72, 173, 140, 1) 33%, rgba(87, 199, 133, 1) 50%, rgba(237, 221, 83, 1) 100%);
            font-family: sans-serif; /* Default font */
            padding-top: 80px; /* Crucial: Pushes content below the fixed navbar */
            min-height: 100vh; /* Ensure body takes full viewport height */
        }

        .calculator-container {
            margin: 2rem auto; /* Center horizontally and add vertical margin */
            max-width: 900px; /* Max width for larger screens */
            width: 95%; /* Responsive width */
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden; /* To contain rounded corners */
            padding: 1.5rem; /* Add padding inside the container */
        }

        .tab-content {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            border: 2px solid transparent; /* Changed to transparent, was causing visible border */
            border-radius: 1rem; /* Adjusted to match container's rounded corners */
            padding: 1rem; /* Added padding inside tab content */
        }
        .tab-content.active {
            display: block;
            opacity: 1;
            /* align-items: center; Removed as it's a block element now */
            border: 2px solid #e2e8f0; /* Light border for active tab */
            border-radius: 1rem; /* Consistent border-radius */
        }
        .tab-btn {
            transition: all 0.2s ease;
            white-space: nowrap;
            /* margin-left:370px; This was pushing buttons too far, removed */
        }
        .tab-btn:hover {
            transform: scale(1.05);
            background-color: #2c7a7b;
        }
        .tab-btn.active {
            background-color: #2c7a7b;
        }
        .error { border: 2px solid red; }
        .tip { color: #2c7a7b; font-style: italic; font-size: 0.9rem; text-align: center; display: none; }
        .tip.visible { display: block; }

        /* .p2 {border: 5px; border-radius: 50%;} - This class is not used in the HTML, commenting out */
        /* .tab-inner { margin: 0 auto; } - This is redundant with .tab-content padding, removed */

        .tab-nav {
            overflow-x: auto;
            white-space: nowrap;
            padding: 0.5rem 1rem;
            background-color: #f3f4f6;
            -webkit-overflow-scrolling: touch;
            border-radius: 0.75rem; /* Smoother corners for tab nav */
            margin-bottom: 1rem; /* Space below tab navigation */
            justify-content: center; /* Centering the tabs */
        }
        .tab-nav::-webkit-scrollbar { height: 8px; }
        .tab-nav::-webkit-scrollbar-thumb { background: #2c7a7b; border-radius: 4px; }

        @media (max-width: 640px) {
            .calculator-container { max-width: 100%; padding: 1rem; }
            /* .tab-inner { max-width: 100%; } - Redundant */
            .tab-nav { padding: 0.5rem; }
            .tab-btn { margin-left: 0; /* Ensure no left margin on small screens */ }
        }
        canvas { max-height: 300px; }
        .tooltip { position: relative; display: inline-block; }
        .tooltip .tooltiptext { visibility: hidden; width: 220px; background-color: #555; color: #fff; text-align: center; border-radius: 6px; padding: 5px; position: absolute; z-index: 1; bottom: 125%; left: 50%; margin-left: -110px; opacity: 0; transition: opacity 0.3s; }
        .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
        .result { text-align: center; margin-top: 1rem; }
        .modal { display: none; position: fixed; z-index: 10; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 600px; border-radius: 8px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: #000; }

        /* Added/Modified for black borders on inputs and selects */
        .input-group input[type="number"],
        .input-group input[type="text"],
        .input-group select,
        .tab-inner input[type="number"],
        .tab-inner select {
            border: 1px solid #000; /* Black border */
        }


        .footer {
 background: #2C3E50;  /* fallback for old browsers */
background: -webkit-linear-gradient(to right, #4CA1AF, #2C3E50);  /* Chrome 10-25, Safari 5.1-6 */
background: linear-gradient(to right, #4CA1AF, #2C3E50); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */

  color: white;
  padding: 20px 20px 20px 20px;
}

.footer-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  /* flex-wrap: wrap; */
}

.footer-section {
  display : flex;
  flex: 1;
  margin: 10px;
}

.footer-section h3{
    font-size: 1.7rem;
    text-align: center;
}

.footer-section h4 {
    font-size: 1.5rem;
    margin-bottom: 15px;
}

.footer-section ul {
  list-style: none;
  padding: 0;
}

.footer-section ul li a {
  color: white;
  text-decoration: none;
}

.footer-section ul li a:hover {
  text-decoration: underline;
}

.footer-section .social a {
  margin-right: 10px;
  color: white;
  font-size: 1.5rem;
}

.footer-bottom {
  text-align: center;
  margin-top: 20px;
  border-top: 1px solid rgba(255,255,255,0.3);
  padding-top: 10px;
  font-size: 0.9rem;
}

.follow {
    padding : 20px;
    font-size: 1.6rem;
}
    </style>
</head>
<body class="bg-gray-100 font-sans min-h-screen"> <!-- Removed flex centering classes -->
    <header>
        <div class="navbar border">
            <div class="logo border">
                <i class="fa-solid fa-leaf"></i>
                <span>EcoConnect</span>
            </div>

            <div class="first-box">
                <div class="nav-links border">
                    <div class="link">
                        <a href="../index.html">
                        <i class="fa-solid fa-house"></i>
                        <span>Home</span>
                        </a>
                    </div>
                </div>

                <div class="nav-links border">
                    <div class="link">
                        <a href="./Community_Forum.html">
                       <i class="fa-solid fa-people-group"></i>
                        <span>Community Forum</span>
                        </a>
                    </div>
                </div>

                <div class="nav-links border">
                    <div class="link">
                        <a href="./Eco-Ride.html">
                        <i class="fa-solid fa-car-side"></i>
                        <span>Eco-Ride</span>
                        </a>
                    </div>
                </div>

                <div class="nav-links border">
                    <div class="link">
                        <a href="./Shopping_Assistant.html">
                        <i class="fa-solid fa-cart-shopping"></i>
                        <span>Shopping Assistant</span>
                        </a>
                    </div>
                </div>

                <div class="nav-links border">
                    <div class="link">
                        <a href="./Education.html">
                        <i class="fa-solid fa-book"></i>
                        <span>Education</span>
                        </a>
                    </div>
                </div>
            </div>

            <div class="nav-links border">
                <div class="profile">
                    <a href="./Profile.html">
                    <i class="fa-solid fa-user"></i>
                    <span>Profile</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Unit and Region Toggle (This content was inside the calculator-container in your snippet,
         but logically it might be part of the overall page controls. I've kept it here
         as it was provided, assuming it's meant to be outside the main calculator content block
         but still below the header.) -->
    <div class="p-4 flex justify-center items-center space-x-4 bg-gray-50">
        <div>
            <label class="text-sm font-medium text-gray-700">Units:</label>
            <select id="unitToggle" class="p-1 text-sm border rounded bg-white" onchange="updateUnits()">
                <option value="imperial">Imperial (mi, gal)</option>
                <option value="metric">Metric (km, L)</option>
            </select>
        </div>
        <div>
            <label class="text-sm font-medium text-gray-700">Region:</label>
            <select id="regionToggle" class="p-1 text-sm border rounded bg-white" onchange="updateResults()">
                <option value="usa">USA</option>
                <option value="eu">EU</option>
                <option value="india">India</option>
                <option value="other">Other</option>
            </select>
        </div>
        <div>
            <label class="text-sm font-medium text-gray-700">Results:</label>
            <select id="resultPeriod" class="p-1 text-sm border rounded bg-white" onchange="updateResults()">
                <option value="year">Per Year</option>
                <option value="month">Per Month</option>
                <option value="day">Per Day</option>
            </select>
        </div>
    </div>

    <div class="calculator-container bg-white rounded-xl shadow-xl overflow-hidden">
        <!-- Tabs Navigation -->
        <div class="tab-nav flex space-x-3 md:space-x-6 justify-center">
            <button class="tab-btn active bg-cyan-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('transport')" data-tab="transport">Travel</button>
            <button class="tab-btn bg-cyan-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('energy')" data-tab="energy">Energy</button>
            <button class="tab-btn bg-cyan-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('food')" data-tab="food">Diet</button>
            <button class="tab-btn bg-cyan-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('consumption')" data-tab="consumption">Shopping</button>
            <button class="tab-btn bg-cyan-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('digital')" data-tab="digital">Digital</button>
            <button class="tab-btn bg-cyan-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('misc')" data-tab="misc">Extras</button>
            <button class="tab-btn bg-teal-600 text-white px-3 py-1 rounded-full text-sm md:text-base shadow-md" onclick="openTab('total')" data-tab="total">Total</button>
        </div>

        <!-- Tab Contents -->
        <div class="p-2">
            <div id="transport" class="tab-content active">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Travel</h2>
                    <p class="font-sans text-sm text-gray-600 mb-2 text-center">How you get around affects your footprint.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div>
                            <label class="text-sm tooltip">Car Distance (<span id="distanceUnit">mi</span>)<span class="tooltiptext">Enter the total distance you drive in a car. Fill this out to see your full impact!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="carDistance" class="w-2/3 p-1 text-sm border rounded" min="0">
                                <select id="carPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm">Fuel Type:</label>
                            <select id="fuelType" class="w-full p-1 text-sm border rounded">
                                <option value="gasoline">Gasoline</option>
                                <option value="diesel">Diesel</option>
                                <option value="electric">Electric</option>
                            </select>
                            <label class="text-sm tooltip">Efficiency (<span id="efficiencyUnit">mi/gal</span>)<span class="tooltiptext">Enter how far your car goes per gallon or liter. Every detail helps!</span>:</label>
                            <input type="number" id="fuelEfficiency" class="w-full p-1 text-sm border rounded" min="1">
                        </div>
                        <div>
                            <label class="text-sm tooltip">Bus Distance (<span id="busUnit">mi</span>/yr)<span class="tooltiptext">Enter your yearly bus travel distance. Every bit counts!</span>:</label>
                            <input type="number" id="busDistance" class="w-full p-1 text-sm border rounded" min="0">
                            <label class="text-sm tooltip">Train Distance (<span id="trainUnit">mi</span>/yr)<span class="tooltiptext">Enter your yearly train travel distance. Fill it in for accuracy!</span>:</label>
                            <input type="number" id="trainDistance" class="w-full p-1 text-sm border rounded" min="0">
                            <label class="text-sm tooltip">Taxi/Rideshare (<span id="taxiUnit">mi</span>)<span class="tooltiptext">Enter distance using Uber, Lyft, etc. Don’t skip this!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="taxiDistance" class="w-2/3 p-1 text-sm border rounded">
                                <select id="taxiPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Flights (<span id="flightUnit">mi</span>)<span class="tooltiptext">Enter total distance flown (e.g., 500 mi for a short trip). Complete this for a full picture!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="flightDistance" class="w-2/3 p-1 text-sm border rounded">
                                <select id="flightPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700" onclick="calcTransport()">Calculate</button>
                    <p class="result font-sans text-sm">Emissions: <span id="transportResult">0</span> kg CO2e</p>
                    <p id="transportTip" class="tip mt-2"></p>
                </div>
            </div>

            <div id="energy" class="tab-content">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Home Energy</h2>
                    <p class="font-sans text-sm text-gray-600 mb-3 text-center">Your home’s energy use matters.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div>
                            <label class="text-sm tooltip">General Electricity (kWh)<span class="tooltiptext">Enter your total electricity use from your bill (lights, appliances). Fill this out for a complete view!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="electricity" class="w-2/3 p-1 text-sm border rounded">
                                <select id="electricityPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">% Renewable<span class="tooltiptext">Enter the percentage of your electricity from solar, wind, etc. (0-100%). Every detail helps!</span>:</label>
                            <input type="number" id="renewable" class="w-full p-1 text-sm border rounded" min="0" max="100">
                            <label class="text-sm tooltip">Cooling Energy<span class="tooltiptext">Enter energy used for air conditioning or fans, separate from general electricity. Don’t skip this!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="cooling" class="w-2/3 p-1 text-sm border rounded">
                                <select id="coolingPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm tooltip">Heating Energy<span class="tooltiptext">Enter energy for heating your home (e.g., gas in therms, electric in kWh), separate from general electricity. Fill this in!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="heating" class="w-2/3 p-1 text-sm border rounded">
                                <select id="heatingUnit" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="therms">therms</option>
                                    <option value="kWh">kWh</option>
                                </select>
                            </div>
                            <select id="heatingPeriod" class="w-full p-1 text-sm border rounded mt-1">
                                <option value="year">/yr</option>
                                <option value="month">/mo</option>
                            </select>
                            <label class="text-sm tooltip">Water Heating Energy<span class="tooltiptext">Enter energy used to heat water (e.g., gas or electric), separate from general use. Complete this for accuracy!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="waterHeating" class="w-2/3 p-1 text-sm border rounded">
                                <select id="waterHeatingUnit" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="therms">therms</option>
                                    <option value="kWh">kWh</option>
                                </select>
                            </div>
                            <select id="waterHeatingPeriod" class="w-full p-1 text-sm border rounded mt-1">
                                <option value="year">/yr</option>
                                <option value="month">/mo</option>
                            </select>
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700" onclick="calcEnergy()">Calculate</button>
                    <p class="result font-sans text-sm">Emissions: <span id="energyResult">0</span> kg CO2e</p>
                    <p id="energyTip" class="tip mt-2"></p>
                </div>
            </div>

            <div id="food" class="tab-content">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Diet</h2>
                    <p class="font-sans text-sm text-gray-600 mb-3 text-center">What you eat impacts the planet.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div>
                            <label class="text-sm tooltip">Diet Type<span class="tooltiptext">Select your typical weekly meals (e.g., vegan = no meat). Fill this out to see your impact!</span>:</label>
                            <select id="dietType" class="w-full p-1 text-sm border rounded">
                                <option value="vegan">Vegan (no animal products)</option>
                                <option value="vegetarian">Vegetarian (no meat)</option>
                                <option value="omnivore">Omnivore (meat occasionally)</option>
                                <option value="highMeat">High-Meat (meat daily)</option>
                            </select>
                            <label class="text-sm tooltip">Weekly Meals<span class="tooltiptext">Enter the number of meals matching your diet type per week. Every meal counts!</span>:</label>
                            <input type="number" id="meals" class="w-full p-1 text-sm border rounded" min="0" placeholder="e.g., 21">
                            <label class="text-sm tooltip">Dairy (kg)<span class="tooltiptext">Enter the weight of milk, cheese, etc., you consume. Don’t skip this!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="dairy" class="w-2/3 p-1 text-sm border rounded" min="0" step="0.1">
                                <select id="dairyPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="week">/wk</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm tooltip">Food Waste (kg)<span class="tooltiptext">Enter the weight of food you throw away (e.g., leftovers). Fill this in for a full picture!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="foodWaste" class="w-2/3 p-1 text-sm border rounded" min="0" step="0.1">
                                <select id="foodWastePeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="week">/wk</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700" onclick="calcFood()">Calculate</button>
                    <p class="result font-sans text-sm">Emissions: <span id="foodResult">0</span> kg CO2e</p>
                    <p id="foodTip" class="tip mt-2"></p>
                </div>
            </div>

            <div id="consumption" class="tab-content">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Shopping</h2>
                    <p class="font-sans text-sm text-gray-600 mb-3 text-center">Your purchases affect emissions.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div>
                            <label class="text-sm tooltip">Clothing Items<span class="tooltiptext">Enter the number of new clothes bought (e.g., shirts). Fill this out to track your impact!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="clothing" class="w-2/3 p-1 text-sm border rounded">
                                <select id="clothingPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Electronics<span class="tooltiptext">Enter the number of new devices (e.g., phone, TV). Every item matters!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="electronics" class="w-2/3 p-1 text-sm border rounded">
                                <select id="electronicsPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Appliances<span class="tooltiptext">Enter the number of new items (e.g., fridge, microwave). Don’t skip this!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="appliances" class="w-2/3 p-1 text-sm border rounded">
                                <select id="appliancesPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm tooltip">Furniture<span class="tooltiptext">Enter the number of new items (e.g., sofa, table). Fill this in for accuracy!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="furniture" class="w-2/3 p-1 text-sm border rounded">
                                <select id="furniturePeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Packaging (kg)<span class="tooltiptext">Enter the weight of plastic/paper waste from shopping. Every bit helps!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="packaging" class="w-2/3 p-1 text-sm border rounded" min="0" step="0.1">
                                <select id="packagingPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="week">/wk</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Waste (kg)<span class="tooltiptext">Enter the weight of trash not recycled. Complete this for a full picture!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="waste" class="w-2/3 p-1 text-sm border rounded" min="0" step="0.1">
                                <select id="wastePeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="week">/wk</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">% Recycled<span class="tooltiptext">Enter the percentage of waste you recycle (0-100%). Fill this out!</span>:</label>
                            <input type="number" id="recycled" class="w-full p-1 text-sm border rounded" min="0" max="100">
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700" onclick="calcConsumption()">Calculate</button>
                    <p class="result font-sans text-sm">Emissions: <span id="consumptionResult">0</span> kg CO2e</p>
                    <p id="consumptionTip" class="tip mt-2"></p>
                </div>
            </div>

            <div id="digital" class="tab-content">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Digital Footprint</h2>
                    <p class="font-sans text-sm text-gray-600 mb-3 text-center">Your online activity has an impact.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div>
                            <label class="text-sm tooltip">Streaming (hours)<span class="tooltiptext">Enter hours spent streaming video/audio daily. Fill this out to see your digital impact!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="streaming" class="w-2/3 p-1 text-sm border rounded">
                                <select id="streamingPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="day">/day</option>
                                    <option value="week">/wk</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Internet Use (hours)<span class="tooltiptext">Enter hours of general browsing or social media daily. Every hour counts!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="internet" class="w-2/3 p-1 text-sm border rounded">
                                <select id="internetPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="day">/day</option>
                                    <option value="week">/wk</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm tooltip">Device Charging (kWh)<span class="tooltiptext">Enter energy used to charge devices (e.g., phone, laptop). Don’t skip this!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="charging" class="w-2/3 p-1 text-sm border rounded">
                                <select id="chargingPeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="week">/wk</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700" onclick="calcDigital()">Calculate</button>
                    <p class="result font-sans text-sm">Emissions: <span id="digitalResult">0</span> kg CO2e</p>
                    <p id="digitalTip" class="tip mt-2"></p>
                </div>
            </div>

            <div id="misc" class="tab-content">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Extras</h2>
                    <p class="font-sans text-sm text-gray-600 mb-3 text-center">Daily habits and offsets.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <div>
                            <label class="text-sm tooltip">People in Home<span class="tooltiptext">Enter the number of people sharing energy and food use. Fill this out for accuracy!</span>:</label>
                            <input type="number" id="household" class="w-full p-1 text-sm border rounded" min="1" placeholder="e.g., 2">
                            <label class="text-sm tooltip">Daily Travel (<span id="commuteUnit">mi</span>)<span class="tooltiptext">Enter the distance you travel to work or school. Every trip counts!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="commuteDistance" class="w-2/3 p-1 text-sm border rounded">
                                <select id="commutePeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="week">/wk</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                            <label class="text-sm tooltip">Leisure Travel (<span id="leisureUnit">mi</span>)<span class="tooltiptext">Enter distance for vacation or weekend trips by car/plane. Don’t skip this!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="leisureDistance" class="w-2/3 p-1 text-sm border rounded">
                                <select id="leisurePeriod" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="year">/yr</option>
                                    <option value="month">/mo</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="text-sm tooltip">Carbon Offsets<span class="tooltiptext">Enter efforts to reduce your footprint (e.g., trees planted). Fill this in to see your net impact!</span>:</label>
                            <div class="flex space-x-1">
                                <input type="number" id="offsets" class="w-2/3 p-1 text-sm border rounded" min="0" step="0.1">
                                <select id="offsetUnit" class="w-1/3 p-1 text-sm border rounded">
                                    <option value="tons">tons CO2e/yr</option>
                                    <option value="trees">trees planted</option>
                                    <option value="kWh">renewable kWh</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700" onclick="calcMisc()">Calculate</button>
                    <p class="result font-sans text-sm">Emissions: <span id="miscResult">0</span> kg CO2e</p>
                    <p id="miscTip" class="tip mt-2"></p>
                </div>
            </div>

            <div id="total" class="tab-content">
                <div class="tab-inner">
                    <h2 class="font-sans text-xl font-semibold text-gray-800 mb-2 text-center">Total Footprint</h2>
                    <p class="font-sans text-sm text-gray-600 mb-3 text-center">Your overall impact.</p>
                    <div class="flex justify-center items-center h-48">
                        <canvas id="myPieChart"></canvas>
                    </div>
                    <p class="result font-sans text-lg font-bold">Total Emissions: <span id="totalResult">0</span> kg CO2e</p>
                    <p id="totalTip" class="tip mt-2"></p>
                    <button class="mt-4 w-full bg-teal-600 text-white px-4 py-2 rounded-lg hover:bg-teal-700" onclick="resetForm()">Reset</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for error messages -->
    <div id="errorModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <p id="modalMessage" class="text-red-600"></p>
        </div>
    </div>

    <script>
        // Global variables for results and Chart.js instance
        let transportEmissions = 0;
        let energyEmissions = 0;
        let foodEmissions = 0;
        let consumptionEmissions = 0;
        let digitalEmissions = 0;
        let miscEmissions = 0;
        let myPieChart; // Declare chart variable globally

        // Conversion factors (kg CO2e per unit)
        const factors = {
            usa: {
                carGasoline: 2.31, // kg CO2e per liter (approx. 8.7 kg/gallon)
                carDiesel: 2.68, // kg CO2e per liter (approx. 10.1 kg/gallon)
                carElectric: 0.4, // kg CO2e per kWh (grid average)
                bus: 0.10, // kg CO2e per km
                train: 0.04, // kg CO2e per km
                taxi: 0.15, // kg CO2e per km (higher due to single passenger)
                flightShort: 0.20, // kg CO2e per km (short-haul)
                flightLong: 0.10, // kg CO2e per km (long-haul)
                electricity: 0.42, // kg CO2e per kWh (US grid average)
                heatingTherms: 5.3, // kg CO2e per therm (natural gas)
                heatingKwh: 0.2, // kg CO2e per kWh (electric heating)
                waterHeatingTherms: 5.3,
                waterHeatingKwh: 0.2,
                veganMeal: 0.5, // kg CO2e per meal
                vegetarianMeal: 1.5,
                omnivoreMeal: 2.5,
                highMeatMeal: 4.0,
                dairy: 1.3, // kg CO2e per kg dairy
                foodWaste: 2.5, // kg CO2e per kg food waste (decomposition)
                clothing: 10, // kg CO2e per item (average)
                electronics: 50, // kg CO2e per item (average)
                appliances: 100, // kg CO2e per item (average)
                furniture: 200, // kg CO2e per item (average)
                packaging: 2, // kg CO2e per kg packaging
                waste: 1.5, // kg CO2e per kg unrecycled waste
                streaming: 0.05, // kg CO2e per hour
                internet: 0.02, // kg CO2e per hour
                charging: 0.01, // kg CO2e per kWh
                treeOffset: 20, // kg CO2e absorbed per tree per year (rough average)
                renewableKwhOffset: 0.42 // kg CO2e offset per kWh renewable energy generated (equals grid emission)
            },
            eu: {
                carGasoline: 2.31, // Same as US for consistency, adjust if needed
                carDiesel: 2.68,
                carElectric: 0.27, // EU grid average is lower
                bus: 0.08,
                train: 0.03,
                taxi: 0.12,
                flightShort: 0.18,
                flightLong: 0.09,
                electricity: 0.27, // kg CO2e per kWh (EU grid average)
                heatingTherms: 5.3, // Assuming similar gas
                heatingKwh: 0.15, // Lower electric heating due to cleaner grid
                waterHeatingTherms: 5.3,
                waterHeatingKwh: 0.15,
                veganMeal: 0.4,
                vegetarianMeal: 1.2,
                omnivoreMeal: 2.0,
                highMeatMeal: 3.5,
                dairy: 1.2,
                foodWaste: 2.0,
                clothing: 8,
                electronics: 40,
                appliances: 80,
                furniture: 150,
                packaging: 1.8,
                waste: 1.2,
                streaming: 0.04,
                internet: 0.015,
                charging: 0.008,
                treeOffset: 20,
                renewableKwhOffset: 0.27
            },
            india: {
                carGasoline: 2.31, // Same for now, can be refined
                carDiesel: 2.68,
                carElectric: 0.75, // India grid average is higher
                bus: 0.12,
                train: 0.05,
                taxi: 0.18,
                flightShort: 0.22,
                flightLong: 0.11,
                electricity: 0.75, // kg CO2e per kWh (India grid average)
                heatingTherms: 5.3, // Less relevant for most of India, but included
                heatingKwh: 0.3,
                waterHeatingTherms: 5.3,
                waterHeatingKwh: 0.3,
                veganMeal: 0.6, // Slightly higher due to local practices
                vegetarianMeal: 1.8,
                omnivoreMeal: 2.8,
                highMeatMeal: 4.5,
                dairy: 1.5,
                foodWaste: 3.0,
                clothing: 12,
                electronics: 60,
                appliances: 120,
                furniture: 250,
                packaging: 2.5,
                waste: 1.8,
                streaming: 0.06,
                internet: 0.025,
                charging: 0.012,
                treeOffset: 20,
                renewableKwhOffset: 0.75
            },
            other: { // Default/fallback if no specific region matches
                carGasoline: 2.31,
                carDiesel: 2.68,
                carElectric: 0.5,
                bus: 0.10,
                train: 0.04,
                taxi: 0.15,
                flightShort: 0.20,
                flightLong: 0.10,
                electricity: 0.5,
                heatingTherms: 5.3,
                heatingKwh: 0.25,
                waterHeatingTherms: 5.3,
                waterHeatingKwh: 0.25,
                veganMeal: 0.5,
                vegetarianMeal: 1.5,
                omnivoreMeal: 2.5,
                highMeatMeal: 4.0,
                dairy: 1.3,
                foodWaste: 2.5,
                clothing: 10,
                electronics: 50,
                appliances: 100,
                furniture: 200,
                packaging: 2,
                waste: 1.5,
                streaming: 0.05,
                internet: 0.02,
                charging: 0.01,
                treeOffset: 20,
                renewableKwhOffset: 0.5
            }
        };

        // Helper function to get current factors based on selected region
        function getCurrentFactors() {
            const region = document.getElementById('regionToggle').value;
            return factors[region] || factors['other'];
        }

        // Helper function to convert input to yearly value
        function convertToYearly(value, period) {
            if (period === 'month') return value * 12;
            if (period === 'week') return value * 52;
            if (period === 'day') return value * 365;
            return value; // Already yearly
        }

        // Helper function to convert yearly value to selected result period
        function convertFromYearly(value) {
            const period = document.getElementById('resultPeriod').value;
            if (period === 'month') return value / 12;
            if (period === 'day') return value / 365;
            return value; // Already yearly
        }

        // Function to show modal message
        function showModal(message) {
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('errorModal').style.display = 'block';
        }

        // Function to close modal
        function closeModal() {
            document.getElementById('errorModal').style.display = 'none';
        }

        // Input validation function
        function validateInput(inputElement, min = 0, max = Infinity) {
            inputElement.classList.remove('error');
            const value = parseFloat(inputElement.value);
            if (isNaN(value) || value < min || value > max) {
                inputElement.classList.add('error');
                return null;
            }
            return value;
        }

        // Update unit labels based on toggle
        function updateUnits() {
            const unitType = document.getElementById('unitToggle').value;
            const distanceUnit = unitType === 'imperial' ? 'mi' : 'km';
            const volumeUnit = unitType === 'imperial' ? 'gal' : 'L';

            document.getElementById('distanceUnit').textContent = distanceUnit;
            document.getElementById('efficiencyUnit').textContent = `${distanceUnit}/${volumeUnit}`;
            document.getElementById('busUnit').textContent = `${distanceUnit}/yr`;
            document.getElementById('trainUnit').textContent = `${distanceUnit}/yr`;
            document.getElementById('taxiUnit').textContent = distanceUnit;
            document.getElementById('flightUnit').textContent = distanceUnit;
            document.getElementById('commuteUnit').textContent = distanceUnit;
            document.getElementById('leisureUnit').textContent = distanceUnit;

            // Trigger recalculation for current active tab
            const activeTab = document.querySelector('.tab-content.active').id;
            if (activeTab === 'transport') calcTransport();
            else if (activeTab === 'energy') calcEnergy();
            else if (activeTab === 'food') calcFood();
            else if (activeTab === 'consumption') calcConsumption();
            else if (activeTab === 'digital') calcDigital();
            else if (activeTab === 'misc') calcMisc();
            // ... other tabs if they use units
            updateResults(); // Update total and chart
        }

        // Calculate Transport Emissions
        function calcTransport() {
            const factors = getCurrentFactors();
            const unitType = document.getElementById('unitToggle').value;

            let carDistance = validateInput(document.getElementById('carDistance'));
            const carPeriod = document.getElementById('carPeriod').value;
            const fuelType = document.getElementById('fuelType').value;
            let fuelEfficiency = validateInput(document.getElementById('fuelEfficiency'), 1);

            let busDistance = validateInput(document.getElementById('busDistance'));
            let trainDistance = validateInput(document.getElementById('trainDistance'));
            let taxiDistance = validateInput(document.getElementById('taxiDistance'));
            const taxiPeriod = document.getElementById('taxiPeriod').value;
            let flightDistance = validateInput(document.getElementById('flightDistance'));
            const flightPeriod = document.getElementById('flightPeriod').value;

            if (carDistance === null || fuelEfficiency === null || busDistance === null || trainDistance === null || taxiDistance === null || flightDistance === null) {
                transportEmissions = 0;
                document.getElementById('transportResult').textContent = 'Invalid input';
                document.getElementById('transportTip').classList.remove('visible');
                updateResults();
                return;
            }

            carDistance = convertToYearly(carDistance, carPeriod);
            taxiDistance = convertToYearly(taxiDistance, taxiPeriod);
            flightDistance = convertToYearly(flightDistance, flightPeriod);

            let carEmissions = 0;
            if (fuelType === 'electric') {
                carEmissions = carDistance * factors.carElectric; // kWh/km, no fuel efficiency needed here
            } else {
                const volumeFactor = unitType === 'imperial' ? 3.785 : 1; // Convert gallons to liters for metric factors
                const fuelConsumed = carDistance / fuelEfficiency; // gallons or liters
                carEmissions = fuelConsumed * (fuelType === 'gasoline' ? factors.carGasoline : factors.carDiesel) * volumeFactor;
            }

            const busEmissions = busDistance * factors.bus;
            const trainEmissions = trainDistance * factors.train;
            const taxiEmissions = taxiDistance * factors.taxi;
            const flightEmissions = (flightDistance * factors.flightLong); // Simplified, could differentiate short/long haul

            transportEmissions = carEmissions + busEmissions + trainEmissions + taxiEmissions + flightEmissions;
            document.getElementById('transportResult').textContent = convertFromYearly(transportEmissions).toFixed(2);
            showTip('transportTip', transportEmissions);
            updateResults();
        }

        // Calculate Energy Emissions
        function calcEnergy() {
            const factors = getCurrentFactors();

            let electricity = validateInput(document.getElementById('electricity'));
            const electricityPeriod = document.getElementById('electricityPeriod').value;
            let renewable = validateInput(document.getElementById('renewable'), 0, 100);
            let cooling = validateInput(document.getElementById('cooling'));
            const coolingPeriod = document.getElementById('coolingPeriod').value;
            let heating = validateInput(document.getElementById('heating'));
            const heatingUnit = document.getElementById('heatingUnit').value;
            const heatingPeriod = document.getElementById('heatingPeriod').value;
            let waterHeating = validateInput(document.getElementById('waterHeating'));
            const waterHeatingUnit = document.getElementById('waterHeatingUnit').value;
            const waterHeatingPeriod = document.getElementById('waterHeatingPeriod').value;

            if (electricity === null || renewable === null || cooling === null || heating === null || waterHeating === null) {
                energyEmissions = 0;
                document.getElementById('energyResult').textContent = 'Invalid input';
                document.getElementById('energyTip').classList.remove('visible');
                updateResults();
                return;
            }

            electricity = convertToYearly(electricity, electricityPeriod);
            cooling = convertToYearly(cooling, coolingPeriod);
            heating = convertToYearly(heating, heatingPeriod);
            waterHeating = convertToYearly(waterHeating, waterHeatingPeriod);

            let electricityEmissions = electricity * factors.electricity * (1 - renewable / 100);
            let coolingEmissions = cooling * factors.electricity; // Assuming cooling uses grid electricity
            let heatingEmissions = heating * (heatingUnit === 'therms' ? factors.heatingTherms : factors.heatingKwh);
            let waterHeatingEmissions = waterHeating * (waterHeatingUnit === 'therms' ? factors.waterHeatingTherms : factors.waterHeatingKwh);

            energyEmissions = electricityEmissions + coolingEmissions + heatingEmissions + waterHeatingEmissions;
            document.getElementById('energyResult').textContent = convertFromYearly(energyEmissions).toFixed(2);
            showTip('energyTip', energyEmissions);
            updateResults();
        }

        // Calculate Food Emissions
        function calcFood() {
            const factors = getCurrentFactors();

            const dietType = document.getElementById('dietType').value;
            let meals = validateInput(document.getElementById('meals'));
            let dairy = validateInput(document.getElementById('dairy'));
            const dairyPeriod = document.getElementById('dairyPeriod').value;
            let foodWaste = validateInput(document.getElementById('foodWaste'));
            const foodWastePeriod = document.getElementById('foodWastePeriod').value;

            if (meals === null || dairy === null || foodWaste === null) {
                foodEmissions = 0;
                document.getElementById('foodResult').textContent = 'Invalid input';
                document.getElementById('foodTip').classList.remove('visible');
                updateResults();
                return;
            }

            meals = convertToYearly(meals, 'week') / 7 * 365; // Convert weekly meals to yearly meals
            dairy = convertToYearly(dairy, dairyPeriod);
            foodWaste = convertToYearly(foodWaste, foodWastePeriod);

            let dietEmissions = 0;
            if (dietType === 'vegan') dietEmissions = meals * factors.veganMeal;
            else if (dietType === 'vegetarian') dietEmissions = meals * factors.vegetarianMeal;
            else if (dietType === 'omnivore') dietEmissions = meals * factors.omnivoreMeal;
            else if (dietType === 'highMeat') dietEmissions = meals * factors.highMeatMeal;

            const dairyEmissions = dairy * factors.dairy;
            const foodWasteEmissions = foodWaste * factors.foodWaste;

            foodEmissions = dietEmissions + dairyEmissions + foodWasteEmissions;
            document.getElementById('foodResult').textContent = convertFromYearly(foodEmissions).toFixed(2);
            showTip('foodTip', foodEmissions);
            updateResults();
        }

        // Calculate Consumption Emissions
        function calcConsumption() {
            const factors = getCurrentFactors();

            let clothing = validateInput(document.getElementById('clothing'));
            const clothingPeriod = document.getElementById('clothingPeriod').value;
            let electronics = validateInput(document.getElementById('electronics'));
            const electronicsPeriod = document.getElementById('electronicsPeriod').value;
            let appliances = validateInput(document.getElementById('appliances'));
            const appliancesPeriod = document.getElementById('appliancesPeriod').value;
            let furniture = validateInput(document.getElementById('furniture'));
            const furniturePeriod = document.getElementById('furniturePeriod').value;
            let packaging = validateInput(document.getElementById('packaging'));
            const packagingPeriod = document.getElementById('packagingPeriod').value;
            let waste = validateInput(document.getElementById('waste'));
            const wastePeriod = document.getElementById('wastePeriod').value;
            let recycled = validateInput(document.getElementById('recycled'), 0, 100);

            if (clothing === null || electronics === null || appliances === null || furniture === null || packaging === null || waste === null || recycled === null) {
                consumptionEmissions = 0;
                document.getElementById('consumptionResult').textContent = 'Invalid input';
                document.getElementById('consumptionTip').classList.remove('visible');
                updateResults();
                return;
            }

            clothing = convertToYearly(clothing, clothingPeriod);
            electronics = convertToYearly(electronics, electronicsPeriod);
            appliances = convertToYearly(appliances, appliancesPeriod);
            furniture = convertToYearly(furniture, furniturePeriod);
            packaging = convertToYearly(packaging, packagingPeriod);
            waste = convertToYearly(waste, wastePeriod);

            const clothingEmissions = clothing * factors.clothing;
            const electronicsEmissions = electronics * factors.electronics;
            const appliancesEmissions = appliances * factors.appliances;
            const furnitureEmissions = furniture * factors.furniture;
            const packagingEmissions = packaging * factors.packaging;
            const wasteEmissions = waste * factors.waste * (1 - recycled / 100); // Reduce waste emissions by recycling percentage

            consumptionEmissions = clothingEmissions + electronicsEmissions + appliancesEmissions + furnitureEmissions + packagingEmissions + wasteEmissions;
            document.getElementById('consumptionResult').textContent = convertFromYearly(consumptionEmissions).toFixed(2);
            showTip('consumptionTip', consumptionEmissions);
            updateResults();
        }

        // Calculate Digital Footprint Emissions
        function calcDigital() {
            const factors = getCurrentFactors();

            let streaming = validateInput(document.getElementById('streaming'));
            const streamingPeriod = document.getElementById('streamingPeriod').value;
            let internet = validateInput(document.getElementById('internet'));
            const internetPeriod = document.getElementById('internetPeriod').value;
            let charging = validateInput(document.getElementById('charging'));
            const chargingPeriod = document.getElementById('chargingPeriod').value;

            if (streaming === null || internet === null || charging === null) {
                digitalEmissions = 0;
                document.getElementById('digitalResult').textContent = 'Invalid input';
                document.getElementById('digitalTip').classList.remove('visible');
                updateResults();
                return;
            }

            streaming = convertToYearly(streaming, streamingPeriod);
            internet = convertToYearly(internet, internetPeriod);
            charging = convertToYearly(charging, chargingPeriod);

            const streamingEmissions = streaming * factors.streaming;
            const internetEmissions = internet * factors.internet;
            const chargingEmissions = charging * factors.charging;

            digitalEmissions = streamingEmissions + internetEmissions + chargingEmissions;
            document.getElementById('digitalResult').textContent = convertFromYearly(digitalEmissions).toFixed(2);
            showTip('digitalTip', digitalEmissions);
            updateResults();
        }

        // Calculate Miscellaneous Emissions
        function calcMisc() {
            const factors = getCurrentFactors();

            let household = validateInput(document.getElementById('household'), 1);
            let commuteDistance = validateInput(document.getElementById('commuteDistance'));
            const commutePeriod = document.getElementById('commutePeriod').value;
            let leisureDistance = validateInput(document.getElementById('leisureDistance'));
            const leisurePeriod = document.getElementById('leisurePeriod').value;
            let offsets = validateInput(document.getElementById('offsets'));
            const offsetUnit = document.getElementById('offsetUnit').value;

            if (household === null || commuteDistance === null || leisureDistance === null || offsets === null) {
                miscEmissions = 0;
                document.getElementById('miscResult').textContent = 'Invalid input';
                document.getElementById('miscTip').classList.remove('visible');
                updateResults();
                return;
            }

            commuteDistance = convertToYearly(commuteDistance, commutePeriod);
            leisureDistance = convertToYearly(leisureDistance, leisurePeriod);

            // Assuming commute and leisure travel are by car for simplicity in misc category
            const commuteEmissions = (commuteDistance * factors.carGasoline) / household; // Per person
            const leisureEmissions = (leisureDistance * factors.flightLong) / household; // Per person

            let offsetAmount = 0;
            if (offsetUnit === 'tons') offsetAmount = offsets * 1000; // Convert tons to kg
            else if (offsetUnit === 'trees') offsetAmount = offsets * factors.treeOffset;
            else if (offsetUnit === 'kWh') offsetAmount = offsets * factors.renewableKwhOffset;

            miscEmissions = (commuteEmissions + leisureEmissions) - offsetAmount;
            document.getElementById('miscResult').textContent = convertFromYearly(miscEmissions).toFixed(2);
            showTip('miscTip', miscEmissions);
            updateResults();
        }

        // Update total results and Chart.js pie chart
        function updateResults() {
            const totalEmissions = transportEmissions + energyEmissions + foodEmissions + consumptionEmissions + digitalEmissions + miscEmissions;
            document.getElementById('totalResult').textContent = convertFromYearly(totalEmissions).toFixed(2);
            showTip('totalTip', totalEmissions);

            // Update Chart.js data
            const ctx = document.getElementById('myPieChart').getContext('2d');

            const data = {
                labels: ['Travel', 'Home Energy', 'Diet', 'Shopping', 'Digital', 'Extras'],
                datasets: [{
                    data: [
                        convertFromYearly(transportEmissions),
                        convertFromYearly(energyEmissions),
                        convertFromYearly(foodEmissions),
                        convertFromYearly(consumptionEmissions),
                        convertFromYearly(digitalEmissions),
                        convertFromYearly(miscEmissions)
                    ],
                    backgroundColor: [
                        '#06B6D4', // Cyan 500
                        '#22C55E', // Green 500
                        '#F59E0B', // Amber 500
                        '#EF4444', // Red 500
                        '#6366F1', // Indigo 500
                        '#8B5CF6'  // Violet 500
                    ],
                    hoverOffset: 4
                }]
            };

            if (myPieChart) {
                myPieChart.data = data;
                myPieChart.update();
            } else {
                myPieChart = new Chart(ctx, {
                    type: 'pie',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    font: {
                                        size: 12
                                    }
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed !== null) {
                                            label += context.parsed.toFixed(2) + ' kg CO2e';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        // Show/hide tips based on emission value
        function showTip(tipId, emissions) {
            const tipElement = document.getElementById(tipId);
            tipElement.classList.remove('visible'); // Hide by default

            if (emissions > 5000) {
                tipElement.textContent = 'This category is a major contributor to your footprint. Consider significant changes here!';
                tipElement.classList.add('visible');
            } else if (emissions > 1000) {
                tipElement.textContent = 'This category has a notable impact. Small changes can make a difference.';
                tipElement.classList.add('visible');
            } else if (emissions > 0) {
                tipElement.textContent = 'Good job! Your impact in this area is relatively low.';
                // Add the specific line for transportTip
                if (tipId === 'transportTip') {
                    tipElement.textContent += ' Your travel habits are eco-friendly—keep exploring sustainable options like biking or transit.';
                }
                tipElement.classList.add('visible');
            }
        }

        // Tab switching logic
        function openTab(tabName) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));

            const tabButtons = document.querySelectorAll('.tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');

            // Find the button with the matching data-tab attribute and activate it
            const activeButton = document.querySelector(`.tab-btn[data-tab="${tabName}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            // If switching to total tab, ensure chart is updated
            if (tabName === 'total') {
                updateResults();
            }
        }

        // Reset form inputs and results
        function resetForm() {
            document.querySelectorAll('input[type="number"]').forEach(input => input.value = '');
            document.querySelectorAll('.result span').forEach(span => span.textContent = '0');
            document.querySelectorAll('.tip').forEach(tip => tip.classList.remove('visible'));

            transportEmissions = 0;
            energyEmissions = 0;
            foodEmissions = 0;
            consumptionEmissions = 0;
            digitalEmissions = 0;
            miscEmissions = 0;

            // Reset select elements to default options
            document.getElementById('unitToggle').value = 'imperial';
            document.getElementById('regionToggle').value = 'usa';
            document.getElementById('resultPeriod').value = 'year';
            document.getElementById('fuelType').value = 'gasoline';
            document.getElementById('dietType').value = 'vegan';
            document.getElementById('heatingUnit').value = 'therms';
            document.getElementById('waterHeatingUnit').value = 'therms';
            document.getElementById('offsetUnit').value = 'tons';

            // Reset all period selects to 'year' or default
            document.getElementById('carPeriod').value = 'year';
            document.getElementById('taxiPeriod').value = 'year';
            document.getElementById('flightPeriod').value = 'year';
            document.getElementById('electricityPeriod').value = 'year';
            document.getElementById('coolingPeriod').value = 'year';
            document.getElementById('heatingPeriod').value = 'year';
            document.getElementById('waterHeatingPeriod').value = 'year';
            document.getElementById('dairyPeriod').value = 'week';
            document.getElementById('foodWastePeriod').value = 'week';
            document.getElementById('clothingPeriod').value = 'year';
            document.getElementById('electronicsPeriod').value = 'year';
            document.getElementById('appliancesPeriod').value = 'year';
            document.getElementById('furniturePeriod').value = 'year';
            document.getElementById('packagingPeriod').value = 'week';
            document.getElementById('wastePeriod').value = 'week';
            document.getElementById('streamingPeriod').value = 'day';
            document.getElementById('internetPeriod').value = 'day';
            document.getElementById('chargingPeriod').value = 'week';
            document.getElementById('commutePeriod').value = 'week';
            document.getElementById('leisurePeriod').value = 'year';

            updateUnits(); // Reset unit labels
            updateResults(); // Update chart and total
            openTab('transport'); // Go back to the first tab
        }

        // Initial setup on page load
        document.addEventListener('DOMContentLoaded', () => {
            updateUnits(); // Set initial unit labels
            updateResults(); // Initialize chart with zero data
            openTab('transport'); // Open the first tab by default
        });
    </script>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section border">
            <h3>EcoConnect</h3>
        </div>

        <div class="footer-section social">
            <div class="follow border">
                <i class="fa-brands fa-instagram"></i>
            </div>

            <div class="follow border">
                <i class="fa-brands fa-twitter"></i>
            </div>

            <div class="follow border">
                <i class="fa-brands fa-facebook"></i>
            </div>
        </div>
        

        <div class="footer-bottom border">
        <p>© 2025  All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
